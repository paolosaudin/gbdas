' Gambas class file

' $Author$
' $Revision$
' Purpose : show a table filled with acquired data

Public Sub Form_Open()

    Me.Caption = "Show data"
    Me.Center()

    ' the form is visible
    ModuleMain.FGrid = True

End

Public Sub _New()

    Dim p As ClassParameter
    Dim c As Integer

    With grdData
        .Columns.Count = 9
        .Columns.Width = 100
        .Rows.Count = 1
    End With
    grdData[0, 0].text = "Date"

    c = 1
    For Each p In ModuleMain.ost.Parameters
        grdData[0, c].text = p.Name
        Inc c
    Next

Catch ' errors

End

'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' fill a grid with incoming data v[]
'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Public Sub ShowData(v As Variant[])

    Dim i As Integer
    Dim n As Integer
    Dim m As Integer

    n = v.Count
    Inc grdData.Rows.Count
    i = grdData.Rows.Count
    grdData[i - 1, 0].text = v[0]
    For m = 1 To n - 1
        grdData[i - 1, m].text = v[m]
    Next
    grdData[i - 1, 0].EnsureVisible

Catch ' errors
    grdData.Clear

End

Public Sub btnEsc_Click()

    ' the form is no longer visible
    ModuleMain.FGrid = False

    Me.Close

Catch ' errors
    Message.Error(Error.Text)

End

Public Sub Form_Resize()

    grdData.Move(0, 0, Me.ClientW, Me.ClientH - btnEsc.height - 10)

    btnEsc.Top = Me.ClientH - btnEsc.height - 5
    btnEsc.Left = Me.ClientW - btnEsc.Widtht - 5

Catch ' errors

End
